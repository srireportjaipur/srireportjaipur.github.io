<!DOCTYPE html>
<html class="js no-touch">

<head>
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/fetchImage.js"></script>

    <style>
        * {
            padding: 0pt;
            margin: 0pt
        }

        h3.type.serch-result {
            margin-bottom: 20px;
            margin-top: 20px
        }

        .overflow-div {
            text-align: left;
        }

        .card-front {
            padding: 5px;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            box-sizing: border-box;
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .container-inner {
            width: 100%;
        }

        .g-table th.report-type {
            font-family: Tahoma, Verdana, sans-serif;
            font-weight: bold;
            width: 100%;
            font-size: 13.5pt;
            background-color: green;
            color: white;
            text-align: center
        }

        .table-header {
            width: 100%;
            border-collapse: collapse
        }

        .table-header th,
        .table-header td {
            color: green;
            margin: 0pt;
            padding: 0pt;
            text-align: center;
            font-weight: bold
        }

        img.logo-r {
            width: 57pt
        }

        img.microscope {
            width: 47pt
        }

        img.product {
            width: 95pt
        }

        img.product:hover {
            cursor: zoom-in;
            transform: scale(1.5)
        }

        th.c-name {
            white-space: nowrap;
            font-size: 24px
        }

        th.c-name-hindi {
            white-space: nowrap;
            font-size: 24px
        }

        td.c-add {
            white-space: nowrap;
            font-size: 14px
        }

        .g-table {
            width: 100%;
            line-height: normal;
            border-collapse: collapse
        }

        .g-table th {
            font-family: serif !important;
            white-space: nowrap;
            font-size: 12pt;
            text-align: justify
        }

        .g-table td {
            font-family: serif !important;
            white-space: nowrap;
            font-size: 12pt;
            text-align: justify
        }

        td.r-no,
        th.imp {
            color: darkred;
            font-weight: bold
        }

        span.mm {
            font-weight: bold
        }

        img.qr-code {
            width: 90pt
        }

        img.jksign {
            width: 110pt
        }

        .fg-footer {
            font-family: serif !important;
            white-space: nowrap;
            font-weight: bold;
            border: 1.75px solid green;
            box-shadow: 0px 4px 0px 0px green;
            border-radius: 12pt;
            background-clip: padding-box;
            font-size: 13.5pt;
            background-color: #f3f7d6;
            color: green
        }

        span.sign-text {
            text-align: center;
            color: green;
            font-size: 9pt
        }

        span.sign-text2 {
            text-align: center;
            color: green;
            font-size: 9pt
        }

        @media only screen and (max-width:500px) {
            .overflow-div {
                overflow-x: none;
            }

            .card-front {
                margin-right: 0px;
                margin-left: 0px
            }

            .container-inner {
                width: 242pt
            }

            th.c-name {
                font-size: 14px
            }

            th.c-name-hindi {
                font-size: 14px
            }

            td.c-add {
                font-size: 8px
            }

            img.logo-r {
                width: 38px
            }

            img.microscope {
                width: 30px
            }

            .g-table th.report-type {
                font-size: 8.5pt
            }

            img.product {
                width: 57pt
            }

            img.qr-code {
                width: 60pt
            }

            img.jksign {
                width: 60pt
            }

            .g-table th {
                font-size: 7pt
            }

            .g-table td {
                font-size: 7pt
            }

            span.sign-text {
                text-align: center;
                color: green;
                font-size: 6pt
            }

            span.sign-text2 {
                text-align: center;
                color: green;
                font-size: 7pt
            }

            .fg-footer {
                font-size: 7.5pt
            }
        }
    </style>
</head>

<body
    style="font-family: Arial, sans-serif; background-color: white; margin: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh;">

    <!-- Navigation Bar -->
    <div
        style="width: 100%; background-color: #4A90E2; padding: 20px 40px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); text-align: center;">
        <h1 style="color: #ffffff; font-size: 24px; margin: 0;">Print Card</h1>
    </div>

    <!-- Form Card -->
    <div
        style="background-color: #ffffff; width: 100%; max-width: 400px; margin: 40px 20px; padding: 30px; border-radius: 8px; box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);">
        <form id="gemForm" style="display: flex; flex-direction: column;">
            <label for="reportNumber" style="margin-bottom: 8px; font-weight: 600; color: #333333;">Report
                Number:</label>
            <input type="text" id="reportNumber2" name="reportNumber2" value="SRI/AA/" required
                style="padding: 10px 15px; margin-bottom: 20px; border: 1px solid #cccccc; border-radius: 4px; font-size: 16px;">

            <label for="weight" style="margin-bottom: 8px; font-weight: 600; color: #333333;">Weight:</label>
            <input type="number" step="0.01" name="weight2" required
                style="padding: 10px 15px; margin-bottom: 20px; border: 1px solid #cccccc; border-radius: 4px; font-size: 16px;">

            <button type="submit"
                style="padding: 12px; background-color: #4A90E2; color: #ffffff; border: none; border-radius: 4px; font-size: 16px; cursor: pointer; transition: background-color 0.3s;">
                Submit
            </button>
        </form>
    </div>

    <!-- Printable Card -->
    <div id="printableCard" class="overflow-div" style="padding-right: 5px; margin-bottom: 30px;">
        <div class="card-front">
            <div class="container-inner">
                <table class="table-header">
                    <tbody>
                        <tr>
                            <th rowspan=3><img crossorigin="anonymous"  class="logo-r" src="images/logo.png" style="max-width: 45px;">
                            </th>
                            <th colspan=3 class="c-name">Sri Lab Report</th>
                            <th rowspan=3><img crossorigin="anonymous"  src="images/diamond.png" style="max-width: 45px;">
                            </th>
                        </tr>
                        <tr>
                            <td colspan=3 class="c-add">Gopal GK Road, Jaipur (Rajasthan)</td>
                        </tr>
                </table>
            </div>
            <div class="container-inner">
                <table class="g-table">
                    <tbody>
                        <tr>
                            <th colspan=4 class="report-type" style="border-radius: 20px; margin-left: 20px;">Gems
                                Testing
                                Report</th>
                        </tr>
                        <tr>
                            <th>Submitted By</th>
                            <td colspan=2>: </td>
                            <td colspan=2 style="text-align:center" class="r-no" id="refNo2">RefNo: KGTL/AA/6154</td>
                        </tr>
                        <tr>
                            <th>Colour</th>
                            <td id="colour2">: Red</td>
                            <td rowspan=8 style="text-align:center;padding-left: 30px; width: 200px;">
                                <img crossorigin="anonymous"  id="imgGem2" src="images/loading.gif"  alt=""
                                    style="max-width: 200px; max-height: 100px; ">
                            </td>
                            <td rowspan=7 style="text-align:right">
                                <img crossorigin="anonymous"  src="images/qr.png" alt=""
                                    style="max-width: 100px; margin-right: 20px; margin-top: 20px;">
                            </td>
                        </tr>
                        <tr>
                            <th>Weight</th>
                            <th class="imp" id="weight2">: 5.50 Rt</th>
                        </tr>
                        <tr>
                            <th>Species/Group</th>
                            <td id="species2">: coral</td>
                        </tr>
                        <tr>
                            <th>Shape &amp; Cut</th>
                            <td id="shapeCut2">: capsul</td>
                        </tr>
                        <tr>
                            <th>Transparency</th>
                            <td id="transparency2">: opaque</td>
                        </tr>
                        <tr>
                            <th>Optic Character</th>
                            <td id="opticCharacter2">: none</td>
                        </tr>
                        <tr>
                            <th>R.I</th>
                            <td id="ri2">: 1.486-1.658</td>
                        </tr>
                        <tr>
                            <th>S.G</th>
                            <td id="sg2">: 2.6-2.7</td>
                        </tr>
                        <tr>
                            <th>Hardness</th>
                            <td id="hardness2">: 3.5 </td>
                            <td style="text-align:center">
                                <span class="mm" id="mm2">MM:</span>
                                N/A
                            </td>
                            <td rowspan="1" style="text-align: right; padding-right: 40px;">
                                <img crossorigin="anonymous"  src="images/sign.png" alt="" style="max-height: 30px;">
                            </td>
                        </tr>
                        <tr>
                            <th>Inclusions</th>
                            <td colspan=2 id="inclusions2">: Wood Grain Effect</td>
                            <td><span class="sign-text"> V.K. JAIN, GEMOLOGIST</span></td>
                        </tr>
                        <tr>
                            <th>Remark</th>
                            <td colspan=2 id="remark2">: N-E-H</td>
                            <td><span class="sign-text2" style="margin-left: 3px;"><strong>For , SRI LABS JAIPUR
                                    </strong></span></td>
                        </tr>
                </table>
                <div id="identifyAs2" class="fg-footer" style="text-align:left; margin-top: 4px;">&nbsp; IDENTIFIED AS
                    :-
                    NATURAL:-CORAL(MUNGA)
                </div>
            </div>
        </div>
    </div>

    <button id="download">Download Screenshot</button>

    <div id="capture">
        <h2>Hello World</h2>
        <img crossorigin="anonymous"  src="https://via.placeholder.com/150" crossorigin="anonymous" />
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
        document.getElementById("download").addEventListener("click", () => {
            html2canvas(document.querySelector("#printableCard"), {
                useCORS: true,
                allowTaint: false
            }).then(canvas => {
                let link = document.createElement("a");
                link.download = "screenshot.png";
                link.href = canvas.toDataURL();
                link.click();
            }).catch(err => {
                console.error("Error capturing screenshot:", err);
            });
        });
    </script>



    <!-- Your form fetch script remains unchanged -->
    <script>
        $(document).ready(function () {
            // Handle form submission
            $("#gemForm").on("submit", function (event) {
                event.preventDefault();

                var reportNo = $("input[name='reportNumber2']").val().toString().trim();
                var weight = $("input[name='weight2']").val().toString().trim();
                weight = parseFloat(weight.replace(/[^0-9.]/g, ""));

                if (reportNo && weight) {
                    $.getJSON("https://script.google.com/macros/s/AKfycby0uS8neN8VpbxnmAIdpJbWF6KbsvvlwgbwrlZBc22FtZmtL12MKKs7JSxLPYEiONpd/exec", function (data) {
                        var found = false;
                        $.each(data, function (key, value) {
                            var currentReportNo = value[1].trim();
                            var currentWeight = parseFloat(value[3].toString().trim().replace(/[^0-9.]/g, ""));
                            if (currentReportNo === reportNo && currentWeight === weight) {
                                found = true;
                                const imgElement = document.getElementById("imgGem2");
                                imgElement.src = "images/loading.gif";
                                document.getElementById("identifyAs2").innerHTML = `IDENTIFIED AS :- NATURAL:-${value[4]}:-(${value[0]})`;
                                document.getElementById("refNo2").innerHTML = `<strong>RefNo: </strong>${value[1]}`;
                                document.getElementById("colour2").innerHTML = " : " + value[2];
                                document.getElementById("weight2").innerHTML = " : " + value[3];
                                document.getElementById("species2").innerHTML = " : " + value[4];
                                document.getElementById("shapeCut2").innerHTML = " : " + value[5];
                                document.getElementById("transparency2").innerHTML = " : " + value[6];
                                document.getElementById("opticCharacter2").innerHTML = " : " + value[7];
                                document.getElementById("ri2").innerHTML = " : " + value[8];
                                document.getElementById("sg2").innerHTML = " : " + value[9];
                                document.getElementById("mm2").innerHTML = `<strong>MM:</strong> ${value[10]}`;
                                document.getElementById("hardness2").innerHTML = " : " + value[11];
                                document.getElementById("inclusions2").innerHTML = " : " + value[12];
                                document.getElementById("remark2").innerHTML = " : " + value[13];
                                fetchAndSetImage(value[14], "imgGem2");
                            }
                        });
                        if (!found) {
                            console.log("No matching data found.");
                        }
                    });
                } else {
                    alert("Please enter both Report No and Weight.");
                }
            });
        });
    </script>
</body>

</html>